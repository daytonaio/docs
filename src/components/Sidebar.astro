---
import SidebarSublist from './SidebarSublist.astro'
import { SideNavLinks } from './menu/SideNavLinks'

// Main navigation items that should always be shown
const mainNavItems = [
  {
    type: 'link',
    href: '/docs',
    label: 'Documentation',
    attrs: {
      icon: 'home.svg',
    },
  },
  {
    type: 'link',
    href: '/docs/typescript-sdk',
    label: 'TS SDK Reference',
    attrs: {
      icon: 'package.svg',
    },
  },
  {
    type: 'link',
    href: '/docs/python-sdk',
    label: 'Python SDK Reference',
    attrs: {
      icon: 'package.svg',
    },
  },
]

// TypeScript SDK specific sidebar
const typeScriptSdkSidebar = [
  {
    type: 'group',
    entries: mainNavItems,
  },
  {
    type: 'group',
    label: 'TS SDK Reference',
    entries: [
      {
        type: 'link',
        href: '/docs/typescript-sdk/daytona',
        label: 'Management',
        attrs: {
          icon: 'computer.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/typescript-sdk/file-system',
        label: 'File System',
        attrs: {
          icon: 'folder.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/typescript-sdk/git',
        label: 'Git Operations',
        attrs: {
          icon: 'git-branch.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/typescript-sdk/lsp-server',
        label: 'Language Server Protocol',
        attrs: {
          icon: 'pulse.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/typescript-sdk/process',
        label: 'Process & Code Execution',
        attrs: {
          icon: 'terminal.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/typescript-sdk/sandbox',
        label: 'Sandbox',
        attrs: {
          icon: 'rectangle.svg',
        },
      },
    ],
  },
]

// Python SDK specific sidebar
const pythonSdkSidebar = [
  {
    type: 'group',
    entries: mainNavItems,
  },
  {
    type: 'group',
    label: 'Python SDK Reference',
    entries: [
      {
        type: 'link',
        href: '/docs/python-sdk/daytona',
        label: 'Management',
        attrs: {
          icon: 'computer.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/python-sdk/file-system',
        label: 'File System',
        attrs: {
          icon: 'folder.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/python-sdk/git',
        label: 'Git Operations',
        attrs: {
          icon: 'git-branch.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/python-sdk/lsp-server',
        label: 'Language Server Protocol',
        attrs: {
          icon: 'pulse.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/python-sdk/process',
        label: 'Process & Code Execution',
        attrs: {
          icon: 'terminal.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/python-sdk/sandbox',
        label: 'Sandbox',
        attrs: {
          icon: 'rectangle.svg',
        },
      },
    ],
  },
]

// Standard sidebar for other pages
const standardSidebar = [
  {
    type: 'group',
    entries: mainNavItems,
  },
  {
    type: 'group',
    label: 'About',
    entries: [
      {
        type: 'link',
        href: '/docs/getting-started',
        label: 'Getting Started',
        attrs: {
          icon: 'bookmark.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/configuration',
        label: 'Configuration',
        attrs: {
          icon: 'git-commit.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/sandbox-persistence',
        label: 'Sandbox Persistence',
        attrs: {
          icon: 'samples.svg',
        },
      },
    ],
  },
  {
    type: 'group',
    label: 'Sandboxes',
    entries: [
      {
        type: 'link',
        href: '/docs/sandbox-management',
        label: 'Management',
        attrs: {
          icon: 'computer.svg',
        },
      },
    ],
  },
  {
    type: 'group',
    label: 'Agent Toolbox',
    entries: [
      {
        type: 'link',
        href: '/docs/file-system-operations',
        label: 'File System',
        attrs: {
          icon: 'folder.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/git-operations',
        label: 'Git Operations',
        attrs: {
          icon: 'git-branch.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/language-server-protocol',
        label: 'Language Server Protocol',
        attrs: {
          icon: 'pulse.svg',
        },
      },
      {
        type: 'link',
        href: '/docs/process-code-execution',
        label: 'Process & Code Execution',
        attrs: {
          icon: 'terminal.svg',
        },
      },
    ],
  },
]

let { sidebar } = Astro.props
const currentPath = Astro.url.pathname

// Choose which sidebar to display based on the current path
sidebar = standardSidebar
if (currentPath.includes('/typescript-sdk')) {
  sidebar = typeScriptSdkSidebar
} else if (currentPath.includes('/python-sdk')) {
  sidebar = pythonSdkSidebar
}
---

<SidebarSublist sublist={sidebar} />
<div class="mobile-nav-btn nav__items_side_menu">
  <SideNavLinks client:load />
</div>
